---
  - name: 
    hosts: "{{hostnames}}"
    become: true
    tasks:
    - name: OCC Files Scan
      shell: "sudo /usr/bin/docker exec --user www-data nextcloud_app /usr/local/bin/php /var/www/html/occ files:scan --all"
      register: occ_files_scan_result
    - debug:
        var: occ_files_scan_result.stdout_lines    
    #- name: OCC files scan-app-data
      #shell: "sudo /usr/bin/docker exec --user www-data nextcloud_app /usr/local/bin/php /var/www/html/occ files:scan-app-data"
    #- name: OCC preview pre-generate
      #shell: "sudo /usr/bin/docker exec --user www-data nextcloud_app /usr/local/bin/php /var/www/html/occ preview:pre-generate"
    #- name: OCC preview generate all size
      #shell: "sudo /usr/bin/docker exec --user www-data nextcloud_app /usr/local/bin/php /var/www/html/occ preview:generate-all"
    - name: OCC Memories Indexing
      shell: "sudo /usr/bin/docker exec --user www-data nextcloud_app /usr/local/bin/php /var/www/html/occ memories:index -f"
    - name: Install ffmpeg inside the container
      shell: "sudo /usr/bin/docker exec --user root nextcloud_app bash -c 'apt update && apt -y install ffmpeg'"
      register: install_ffmpeg_result
    - debug:
        var: install_ffmpeg_result.stdout_lines    
    - name: Copy ffmpeg is installed inside the container
      shell: "sudo /usr/bin/docker exec --user root nextcloud_app bash -c 'cp /usr/bin/ff* /usr/local/bin/ff*'"
      register: copy_ffmpeg_result
    - debug:
        var: copy_ffmpeg_result.stdout_lines    
    - name: Verify ffmpeg is installed inside the container
      shell: "sudo /usr/bin/docker exec --user root nextcloud_app bash -c 'ls -lrth /usr/local/bin/ff*'"
      register: list_ffmpeg_result
    - debug:
        var: list_ffmpeg_result.stdout_lines
