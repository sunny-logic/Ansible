---
  - name: 
    hosts: "{{hostnames}}"
    become: true
    tasks:
    - name: Backup Stats
      shell: "sudo {{backup_user}} {{backup_bin}} {{backup_pw}} {{repo}} stats"
      register: stats_result
      tags:
      - stats
    - debug:
        var: stats_result.stdout_lines    
      tags:
      - stats
    - name: Backup
      shell: "sudo -u {{backup_user}} {{backup_bin}} {{backup_pw}} -r {{repo}} backup {{folder1}} {{folder2}}"
      register: backup_result
      tags:
      - backup
    - debug:
        var: backup_result.stdout_lines    
      tags:
      - backup
    - name: Forget backup
      shell: "sudo -u restic /home/restic/bin/restic --password-file /home/restic/.config/rclone/.secret.env -r rclone:mega_remote:Backups/proxtu forget --keep-within-daily 7d --keep-within-weekly 1m --keep-within-monthly 1y --keep-within-yearly 75y"
      register: forget_result
      tags:
      - forget
    - debug:
        var: forget_result.stdout_lines    
      tags:
      - forget
    - name: Prune backup
      shell: "sudo -u restic /home/restic/bin/restic --password-file /home/restic/.config/rclone/.secret.env -r rclone:mega_remote:Backups/proxtu prune"
      register: prune_result
      tags:
      - prune
    - debug:
        var: prune_result.stdout_lines    
      tags:
      - prune
